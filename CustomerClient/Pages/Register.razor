@page "/register"

@using CustomerClient.Data;
@using CustomerClient.Models;
@inject IUserService UsersService
@inject NavigationManager NavigationManager

<h3>Register</h3>

<EditForm Model="@newUser" OnValidSubmit="@AddNewUser">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="form-group">
        Email:<br />
        <InputText rows="1" @bind-Value="newUser.Email"></InputText>
    </div>
    <div class="form-group">
        Name:<br />
        <InputText rows="1" @bind-Value="newUser.Name"></InputText>
    </div>
    <div class="form-group">
        Address:<br />
        <InputText rows="1" @bind-Value="newUser.Address"></InputText>
    </div>
    <div class="form-group">
        Phone Number:<br />
        <InputText rows="1" @bind-Value="newUser.Phone"></InputText>
    </div>
    <div class="form-group">
        Birthday:<br />
        <InputDate type="date" @bind-Value="@_endDate" rows="1"></InputDate>
    </div>
    <div class="form-group">
        Password:<br />
        <InputText type="password" rows="1" @bind-Value="password"></InputText>
    </div>
    <div class="form-group">
        Confirm password:<br />
        <InputText type="password" rows="1" @bind-Value="confirmPassword"></InputText>
    </div>
    <p class="actions">
        <button class="btn btn-outline-dark" type="submit">Create</button>
    </p>
</EditForm>


@code {
    private User newUser = new User();
    private DateTime _endDate;

    private string password;
    private string confirmPassword;

    private void AddNewUser()
    {
        if (password.Equals(confirmPassword))
        {
            newUser.Password = password;
            newUser.Birthday = _endDate;

            UsersService.AddUserAsync(newUser);
            NavigationManager.NavigateTo("/login");
        }
    }
}

